<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h2>プロフィール編集</h2>

      <!-- Devise共通エラー表示（日本語・カタカナに統一される） -->
      <%= render "devise/shared/error_messages", resource: resource %>

      <%= form_for(resource,
            as: resource_name,
            url: registration_path(resource_name),
            html: { method: :put }) do |f| %>

        <!-- 名前 -->
        <div class="mb-3">
          <%= f.label :name, '名前', class: 'form-label' %>
          <%= f.text_field :name,
                class: 'form-control',
                autofocus: true,
                placeholder: '例: 山田 太郎' %>
        </div>

        <!-- メールアドレス -->
        <div class="mb-3">
          <%= f.label :email, 'メールアドレス', class: 'form-label' %>
          <%= f.email_field :email,
                autocomplete: "email",
                class: 'form-control' %>
        </div>

        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <div class="alert alert-info">
            現在、確認待ちのメールアドレス: <%= resource.unconfirmed_email %>
          </div>
        <% end %>

        <hr>

        <h5>パスワード変更（任意）</h5>
        <p class="text-muted small">
          パスワードを変更しない場合は空欄のままにしてください
        </p>

        <!-- 新しいパスワード -->
        <div class="mb-3">
          <%= f.label :password, '新しいパスワード', class: 'form-label' %>
          <%= f.password_field :password,
                autocomplete: "new-password",
                class: 'form-control',
                placeholder: '変更しない場合は空欄' %>
        </div>

        <!-- 新しいパスワード（確認） -->
        <div class="mb-3">
          <%= f.label :password_confirmation,
                '新しいパスワード（確認）',
                class: 'form-label' %>
          <%= f.password_field :password_confirmation,
                autocomplete: "new-password",
                class: 'form-control' %>
        </div>

        <hr>

        <!-- 現在のパスワード（required を削除） -->
        <div class="mb-3">
          <%= f.label :current_password, '現在のパスワード', class: 'form-label' %>
          <%= f.password_field :current_password,
                autocomplete: "current-password",
                class: 'form-control' %>
          <small class="form-text text-muted">
            ※ 変更を保存するには現在のパスワードが必要です
          </small>
        </div>

        <%= f.submit "更新", class: "btn btn-warning w-100" %>
      <% end %>

      <div class="mt-4 text-center">
        <%= link_to "戻る",
              request.referer || root_path,
              class: "btn btn-secondary" %>
      </div>
    </div>
  </div>
</div>
